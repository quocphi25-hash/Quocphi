<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Enjoy Coffee - Order Menu</title>
<style>
body {
  font-family: "Be Vietnam Pro", sans-serif;
  background-color: #e8f5e9;
  color: #333;
  margin: 0;
  padding: 0;
}
header {
  background-color: #2e7d32;
  color: white;
  text-align: center;
  padding: 15px;
  font-size: 22px;
  font-weight: bold;
  letter-spacing: 1px;
}
.container {
  max-width: 800px;
  margin: 20px auto;
  background: white;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}
h2 {
  color: #1b5e20;
  border-bottom: 2px solid #81c784;
  padding-bottom: 6px;
}
.menu-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 0;
  border-bottom: 1px solid #eee;
}
.menu-item select {
  margin-left: 5px;
}
button {
  background-color: #43a047;
  color: white;
  border: none;
  padding: 8px 14px;
  border-radius: 8px;
  cursor: pointer;
  margin: 2px;
}
button:hover {
  background-color: #2e7d32;
}
#order-table {
  width: 100%;
  margin-top: 20px;
  border-collapse: collapse;
}
#order-table th, #order-table td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: center;
}
#order-table th {
  background-color: #a5d6a7;
}
.total {
  text-align: right;
  margin-top: 10px;
  font-weight: bold;
  font-size: 18px;
}
.bill {
  background-color: #f1f8e9;
  padding: 10px;
  margin-top: 20px;
  border-radius: 8px;
  white-space: pre-line;
  font-family: monospace;
}
.history {
  background-color: #e0f2f1;
  padding: 10px;
  border-radius: 8px;
  margin-top: 15px;
}
.delete-btn {
  background-color: #ef5350;
  padding: 4px 10px;
}
.delete-btn:hover {
  background-color: #d32f2f;
}
.export-btn {
  background-color: #1976d2;
  margin-top: 10px;
}
.export-btn:hover {
  background-color: #1565c0;
}
</style>
</head>
<body>
<header>â˜• ENJOY COFFEE - MENU ORDER ğŸ’š</header>
<div class="container">
  <h2>Menu CÃ  phÃª</h2>
  <div class="menu-item">
    <span>CÃ  phÃª sá»¯a</span>
    <div>
      <select class="size">
        <option value="M">M</option>
        <option value="L">L (+4k)</option>
      </select>
      <button onclick="addItem('CÃ  phÃª sá»¯a', 14000, this)">ThÃªm</button>
    </div>
  </div>
  <div class="menu-item">
    <span>CÃ  phÃª Ä‘en</span>
    <div>
      <select class="size">
        <option value="M">M</option>
        <option value="L">L (+4k)</option>
      </select>
      <button onclick="addItem('CÃ  phÃª Ä‘en', 12000, this)">ThÃªm</button>
    </div>
  </div>
  <div class="menu-item">
    <span>CÃ  phÃª sá»¯a tÆ°Æ¡i</span>
    <div>
      <select class="size">
        <option value="M">M</option>
        <option value="L">L (+4k)</option>
      </select>
      <button onclick="addItem('CÃ  phÃª sá»¯a tÆ°Æ¡i', 18000, this)">ThÃªm</button>
    </div>
  </div>
  <div class="menu-item">
    <span>Báº¡c xá»‰u</span>
    <div>
      <select class="size">
        <option value="M">M</option>
        <option value="L">L (+4k)</option>
      </select>
      <button onclick="addItem('Báº¡c xá»‰u', 16000, this)">ThÃªm</button>
    </div>
  </div>

  <h2>CaCao</h2>
  <div class="menu-item">
    <span>CaCao nÃ³ng</span>
    <div>
      <select class="size">
        <option value="M">M</option>
        <option value="L">L (+4k)</option>
      </select>
      <button onclick="addItem('CaCao nÃ³ng', 20000, this)">ThÃªm</button>
    </div>
  </div>
  <div class="menu-item">
    <span>CaCao Ä‘Ã¡</span>
    <div>
      <select class="size">
        <option value="M">M</option>
        <option value="L">L (+4k)</option>
      </select>
      <button onclick="addItem('CaCao Ä‘Ã¡', 20000, this)">ThÃªm</button>
    </div>
  </div>

  <h2>TrÃ  & ÄÃ¡ xay</h2>
  <div class="menu-item"><span>TrÃ  Ä‘Ã o cam sáº£</span><button onclick="addItem('TrÃ  Ä‘Ã o cam sáº£', 25000)">ThÃªm</button></div>
  <div class="menu-item"><span>TrÃ  váº£i</span><button onclick="addItem('TrÃ  váº£i', 25000)">ThÃªm</button></div>
  <div class="menu-item"><span>TrÃ  táº¯c máº­t ong</span><button onclick="addItem('TrÃ  táº¯c máº­t ong', 22000)">ThÃªm</button></div>
  <div class="menu-item"><span>ÄÃ¡ xay socola</span><button onclick="addItem('ÄÃ¡ xay socola', 30000)">ThÃªm</button></div>

  <h2>KhÃ¡c</h2>
  <div class="menu-item"><span>NÆ°á»›c suá»‘i</span><button onclick="addItem('NÆ°á»›c suá»‘i', 10000)">ThÃªm</button></div>
  <div class="menu-item"><span>Sting dÃ¢u</span><button onclick="addItem('Sting dÃ¢u', 12000)">ThÃªm</button></div>
  <div class="menu-item"><span>7Up</span><button onclick="addItem('7Up', 12000)">ThÃªm</button></div>

  <h2>Danh sÃ¡ch Order</h2>
  <table id="order-table">
    <thead><tr><th>MÃ³n</th><th>Size</th><th>GiÃ¡</th><th>XÃ³a</th></tr></thead>
    <tbody id="order-body"></tbody>
  </table>
  <div class="total">Tá»•ng: <span id="total">0</span>Ä‘</div>
  <button onclick="printBill()">Xuáº¥t Bill</button>

  <div class="bill" id="bill-output"></div>

  <h2>Lá»‹ch sá»­ hÃ³a Ä‘Æ¡n</h2>
  <button class="export-btn" onclick="exportToExcel()">Xuáº¥t Excel Lá»‹ch sá»­</button>
  <div class="history" id="history"></div>
</div>

<script>
let orders = [];

function addItem(name, price, el){
  const sizeSelect = el ? el.parentElement.querySelector(".size") : null;
  let size = sizeSelect ? sizeSelect.value : "";
  if(size === "L") price += 4000;
  orders.push({name, size, price});
  renderOrders();
}

function renderOrders(){
  const tbody = document.getElementById("order-body");
  tbody.innerHTML = "";
  orders.forEach((item, index)=>{
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${item.name}</td><td>${item.size||"-"}</td><td>${item.price.toLocaleString()}Ä‘</td>
                    <td><button class="delete-btn" onclick="removeItem(${index})">X</button></td>`;
    tbody.appendChild(tr);
  });
  const total = orders.reduce((a,b)=>a+b.price,0);
  document.getElementById("total").innerText = total.toLocaleString();
}

function removeItem(i){
  orders.splice(i,1);
  renderOrders();
}

function printBill(){
  if(orders.length===0){ 
    alert("ChÆ°a cÃ³ mÃ³n nÃ o!"); 
    return; 
  }
  
  if(!confirm("Báº¡n cÃ³ cháº¯c muá»‘n xuáº¥t bill vÃ  xÃ³a cÃ¡c mÃ³n Ä‘Ã£ Ä‘áº·t?")) {
    return;
  }
  
  const now = new Date();
  const dateStr = now.toLocaleString("vi-VN");
  let total = orders.reduce((a,b)=>a+b.price,0);
  let bill = `====================\n     ENJOY COFFEE â˜•\n====================\n${dateStr}\n\n`;
  orders.forEach((o,i)=> bill += `${i+1}. ${o.name} ${o.size||""} - ${o.price.toLocaleString()}Ä‘\n`);
  bill += `--------------------\nTá»•ng cá»™ng: ${total.toLocaleString()}Ä‘\nâ¤ï¸ Cáº£m Æ¡n quÃ½ khÃ¡ch! â¤ï¸`;
  document.getElementById("bill-output").innerText = bill;
  saveBill(bill, total);
  
  // XÃ³a danh sÃ¡ch Ä‘áº·t hÃ ng
  orders = [];
  renderOrders();
}

function saveBill(bill, total){
  const now = new Date();
  const billData = {
    billText: bill,
    date: now.toLocaleString("vi-VN"),
    items: [...orders],
    total: total
  };
  
  const list = JSON.parse(localStorage.getItem("bills") || "[]");
  list.push(billData);
  localStorage.setItem("bills", JSON.stringify(list));
  loadHistory();
}

function loadHistory(){
  const div = document.getElementById("history");
  const list = JSON.parse(localStorage.getItem("bills") || "[]");
  div.innerHTML = list.map((b, index) => 
    `<div><strong>HÃ³a Ä‘Æ¡n ${index+1} - ${b.date}</strong><pre>${b.billText}</pre></div><hr>`
  ).join("");
}

function exportToExcel() {
  const list = JSON.parse(localStorage.getItem("bills") || "[]");
  if (list.length === 0) {
    alert("KhÃ´ng cÃ³ dá»¯ liá»‡u Ä‘á»ƒ xuáº¥t!");
    return;
  }
  
  // Táº¡o dá»¯ liá»‡u CSV
  let csvContent = "NgÃ y,TÃªn mÃ³n,Size,GiÃ¡\n";
  
  list.forEach(bill => {
    bill.items.forEach(item => {
      csvContent += `"${bill.date}","${item.name}","${item.size || ''}","${item.price}"\n`;
    });
  });
  
  // Táº¡o file vÃ  táº£i vá»
  const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
  const link = document.createElement("a");
  const url = URL.createObjectURL(blob);
  link.setAttribute("href", url);
  link.setAttribute("download", "lich_su_ban_hang.csv");
  link.style.visibility = 'hidden';
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}

loadHistory();
</script>
</body>
</html>
